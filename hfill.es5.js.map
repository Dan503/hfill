{"version":3,"file":"hfill.es5.js","sources":["hfill.js"],"sourcesContent":["// polyfill contextual headings\nexport function observe(scope, rawtag) {\n\tconst tag = rawtag ? rawtag.toLowerCase() : 'x-h';\n\n\t// polyfill existing contextual headings\n\t[].forEach.call(\n\t\tscope.getElementsByTagName(tag),\n\t\tpolyfillContextualHeading\n\t);\n\n\t// polyfill new contextual headings\n\t(new MutationObserver(\n\t\t(mutations) => mutations.forEach(\n\t\t\t(mutation) => {\n\t\t\t\t[].forEach.call(\n\t\t\t\t\tmutation.addedNodes,\n\t\t\t\t\t(node) => {\n\t\t\t\t\t\tif (tag === node.nodeName.toLowerCase()) {\n\t\t\t\t\t\t\tpolyfillContextualHeading(node);\n\t\t\t\t\t\t} else if (node.getElementsByTagName) {\n\t\t\t\t\t\t\t[].forEach.call(\n\t\t\t\t\t\t\t\tnode.getElementsByTagName(tag),\n\t\t\t\t\t\t\t\tpolyfillContextualHeading\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t)\n\t)).observe(\n\t\tscope,\n\t\t{\n\t\t\tchildList: true,\n\t\t\tsubtree: true\n\t\t}\n\t);\n\n\t// polyfill a contextual heading\n\tfunction polyfillContextualHeading(h) {\n\t\t// default level is 1\n\t\tlet level = 1;\n\n\t\t// increase the level for each sectioning ancestor\n\t\tlet ascend = h;\n\n\t\twhile (ascend = ascend.parentElement) {\n\t\t\tif (sectionsMatch.test(ascend.nodeName)) {\n\t\t\t\t++level;\n\t\t\t} else if (ascend.nodeName.toLowerCase() === tag) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t// assign the heading role and aria-level\n\t\th.setAttribute('role', 'heading');\n\t\th.setAttribute('aria-level', level);\n\t}\n}\n\n// style contextual headings\nexport function style(scope, rawtag, cssText, sizes) { // eslint-disable-line max-params\n\tconst tag = rawtag ? rawtag.toLowerCase() : 'x-h';\n\n\tif (scope.querySelector('style#hfill-style')) {\n\t\treturn;\n\t}\n\n\tconst hstyle = document.createElement('style');\n\n\thstyle.setAttribute('id', 'hfill-style');\n\n\thstyle.textContent = [].concat(\n\t\tsizes || ['2em', '1.5em', '1.17em', '1em', '.83em', '.67em']\n\t).reduce(\n\t\t(css, value, level, levels) => { // eslint-disable-line max-params\n\t\t\tconst total = Math.pow(sectionsLength, level);\n\t\t\tconst selectors = [];\n\n\t\t\tfor (let i = -1; ++i < total;) {\n\t\t\t\tconst selector = [];\n\n\t\t\t\tfor (let ii = i, j = -1; ++j < level;) {\n\t\t\t\t\tlet modulus = ii % sectionsLength;\n\n\t\t\t\t\tselector.push(sections[modulus]);\n\n\t\t\t\t\tii = (ii - modulus) / sectionsLength;\n\t\t\t\t}\n\n\t\t\t\tselectors.push(selector);\n\t\t\t}\n\n\t\t\treturn `${ css + selectors.map(\n\t\t\t\t(x) => x.length ? x.join(' ').concat(` ${ tag }`) : tag\n\t\t\t).join(',') }{font-size:${ levels[level] }}`;\n\t\t},\n\t\t`${ tag }{${ cssText || 'display:block;font-weight:bold' }}`\n\t);\n\n\tscope.appendChild(hstyle);\n}\n\n// contextual heading sectioning elements\nconst sections = ['article', 'aside', 'nav', 'section'];\nconst sectionsMatch = RegExp(`^(${ sections.join('|') })$`, 'i');\nconst sectionsLength = sections.length;\n"],"names":["observe","scope","rawtag","polyfillContextualHeading","h","level","ascend","parentElement","sectionsMatch","test","nodeName","toLowerCase","tag","setAttribute","forEach","call","getElementsByTagName","MutationObserver","mutations","mutation","addedNodes","node","style","cssText","sizes","querySelector","hstyle","document","createElement","textContent","concat","reduce","css","value","levels","total","Math","pow","sectionsLength","selectors","i","selector","ii","j","modulus","push","sections","map","x","length","join","appendChild","RegExp"],"mappings":"0BACA,SAAgBA,EAAQC,EAAOC,YAqCrBC,EAA0BC,WAE9BC,EAAQ,EAGRC,EAASF,EAENE,EAASA,EAAOC,kBAClBC,EAAcC,KAAKH,EAAOI,YAC3BL,OACI,GAAIC,EAAOI,SAASC,gBAAkBC,WAM5CC,aAAa,OAAQ,aACrBA,aAAa,aAAcR,OArDxBO,EAAMV,EAASA,EAAOS,cAAgB,SAGzCG,QAAQC,KACVd,EAAMe,qBAAqBJ,GAC3BT,OAIIc,iBACJ,SAACC,UAAcA,EAAUJ,QACxB,SAACK,MACGL,QAAQC,KACVI,EAASC,WACT,SAACC,GACIT,IAAQS,EAAKX,SAASC,gBACCU,GAChBA,EAAKL,yBACZF,QAAQC,KACVM,EAAKL,qBAAqBJ,GAC1BT,SAOJH,QACFC,cAEY,WACF,IA2BZ,SAAgBqB,EAAMrB,EAAOC,EAAQqB,EAASC,OACvCZ,EAAMV,EAASA,EAAOS,cAAgB,UAExCV,EAAMwB,cAAc,0BAIlBC,EAASC,SAASC,cAAc,WAE/Bf,aAAa,KAAM,iBAEnBgB,eAAiBC,OACvBN,IAAU,MAAO,QAAS,SAAU,MAAO,QAAS,UACnDO,OACD,SAACC,EAAKC,EAAO5B,EAAO6B,OAId,IAHCC,EAAQC,KAAKC,IAAIC,EAAgBjC,GACjCkC,KAEGC,GAAK,IAAKA,EAAIL,GAAQ,KAGzB,IAFCM,KAEGC,EAAKF,EAAGG,GAAK,IAAKA,EAAItC,GAAQ,KAClCuC,EAAUF,EAAKJ,IAEVO,KAAKC,EAASF,OAEjBF,EAAKE,GAAWN,IAGbO,KAAKJ,UAGLT,EAAMO,EAAUQ,IAC1B,SAACC,UAAMA,EAAEC,OAASD,EAAEE,KAAK,KAAKpB,WAAYlB,GAAUA,IACnDsC,KAAK,mBAAoBhB,EAAO7B,QAE/BO,OAASW,GAAW,yCAGnB4B,YAAYzB,IAInB,IAAMoB,GAAY,UAAW,QAAS,MAAO,WACvCtC,EAAgB4C,YAAaN,EAASI,KAAK,UAAW,KACtDZ,EAAiBQ,EAASG"}